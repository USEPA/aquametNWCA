<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculate VMMI â€¢ aquametNWCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calculate VMMI">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aquametNWCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CalculateMetrics.html">Calculate Metrics</a>
    </li>
    <li>
      <a href="../articles/CalculateVMMI.html">Calculate VMMI</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculate VMMI</h1>
                        <h4 data-toc-skip class="author">Karen
Blocksom</h4>
            
            <h4 data-toc-skip class="date">2024-09-10</h4>
      

      <div class="hidden name"><code>CalculateVMMI.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="preliminaries">1 Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h2>
<p>The Vegetation Multimetric Index (VMMI) is a measure of biological
condition for wetlands and was developed based on NWCA 2011 vegetation
data. The VMMI consists of 4 metrics, all calculated from vascular plant
data. These are: Floristic Quality Assessment Index based on all species
(FQAI_ALL), number of tolerant species (N_TOL), relative importance of
native species (RIMP_NATSPP), and relative cover of native monocots
(XRCOV_MONOCOTS_NAT). The scoring, or rescaling, of metrics, is based on
interpolating between the 5th and 95th percentiles across all NWCA sites
sampled nationwide. Then the scored metrics are summed and rescaled to a
100-point range for the VMMI score.</p>
<p>Assuming we are starting with raw plant data, we can use the function
<code><a href="../reference/calcVMMImets.html">calcVMMImets()</a></code> to calculate only the 4 metrics included in
the VMMI. Then we can use the function <code><a href="../reference/calcVMMI_fromMets.html">calcVMMI_fromMets()</a></code>
to calculate the VMMI from the metric output.</p>
<p>Condition classes for the VMMI are based on combinations of
aggregated wetland type and aggregated ecoregions. In order to obtain
condition class assignments from the VMMI scores calculated in this
function, we also need to include one of the following in the input data
frame:</p>
<ul>
<li>
<strong>NWCA_ECO4</strong> (NWCA aggregated ecoregions) <em>and</em>
<strong>NWCA_WET_GRP</strong> (NWCA aggregated wetland types)</li>
<li>
<strong>ECO_X_WETGRP</strong> (Combinations of ecoregions and
wetland types in the two variables above)</li>
</ul>
<p>If none of these variables is present in the input data frame, the
VMMI will be calculated but a warning will be generated, and no
condition will be assigned.</p>
</div>
<div class="section level2">
<h2 id="calculating-the-vmmi-metrics">2 Calculating the VMMI metrics<a class="anchor" aria-label="anchor" href="#calculating-the-vmmi-metrics"></a>
</h2>
<p>Using the vascular plant example dataset, <code>VascPlantEx</code>
and the taxa lists included in the package, we first need to prepare the
data for use in the <code><a href="../reference/calcVMMImets.html">calcVMMImets()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">aquametNWCA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">VascPlantEx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   UID STATE USAC_REGION PLOT             USDA_NAME COVER</span></span>
<span><span class="co">## 1   7    FL  CSTL_PLAIN    2 SAGITTARIA LANCIFOLIA    28</span></span>
<span><span class="co">## 2   7    FL  CSTL_PLAIN    3 SAGITTARIA LANCIFOLIA     6</span></span>
<span><span class="co">## 3   7    FL  CSTL_PLAIN    4 SAGITTARIA LANCIFOLIA     5</span></span>
<span><span class="co">## 4   7    FL  CSTL_PLAIN    5 SAGITTARIA LANCIFOLIA    20</span></span>
<span><span class="co">## 5   7    FL  CSTL_PLAIN    5       SPARTINA PATENS     0</span></span>
<span><span class="co">## 6   7    FL  CSTL_PLAIN    1      PANICUM VIRGATUM     0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exPlant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nwcaVegData.html">nwcaVegData</a></span><span class="op">(</span><span class="va">VascPlantEx</span>,</span>
<span>  sampID <span class="op">=</span> <span class="st">"UID"</span>, taxon_name <span class="op">=</span> <span class="st">"USDA_NAME"</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"STATE"</span>, coeReg <span class="op">=</span> <span class="st">"USAC_REGION"</span>, cValReg <span class="op">=</span> <span class="st">"STATE"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Done with plot summing"</span></span>
<span><span class="co">## [1] "Done with sampID summing"</span></span>
<span><span class="co">## [1] "Done with plot summing"</span></span>
<span><span class="co">## [1] "Done with sampID summing"</span></span>
<span><span class="co">## [1] "Done with plot summing"</span></span>
<span><span class="co">## [1] "Done with sampID summing"</span></span>
<span><span class="co">## [1] "Done preparing datasets"</span></span></code></pre>
<p>Now we can use the <code>byUIDspp</code> data frame from the output
above to calculate the VMMI. Then we need to cast the data frame into
wide format.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcVMMImets.html">calcVMMImets</a></span><span class="op">(</span><span class="va">exPlant</span><span class="op">$</span><span class="va">byUIDspp</span>, sampID <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mets</span><span class="op">)</span> <span class="co"># Already in wide format</span></span></code></pre></div>
<pre><code><span><span class="co">##   UID FQAI_ALL N_TOL RIMP_NATSPP XRCOV_MONOCOTS_NAT</span></span>
<span><span class="co">## 1   1    20.27     8      100.00               0.60</span></span>
<span><span class="co">## 2   2    31.43    16       96.29               3.73</span></span>
<span><span class="co">## 3   3    21.39     9       87.97              89.47</span></span>
<span><span class="co">## 4   4    30.41    11       96.74               3.27</span></span>
<span><span class="co">## 5   5    16.33     0      100.00              98.37</span></span>
<span><span class="co">## 6   6    40.23    36       95.42              19.88</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="calculating-the-vmmi">3 Calculating the VMMI<a class="anchor" aria-label="anchor" href="#calculating-the-vmmi"></a>
</h2>
<p>Now we are ready to calculate the VMMI and assign a condition class.
We need to merge a data frame with the necessary site-related variables.
For the purposes of illustration, we will create that data frame here,
but ideally it would be available in a separate data set or included in
the input data frame above.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  UID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, NWCA_ECO4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CPL"</span>, <span class="st">"CPL"</span>, <span class="st">"IPL"</span>, <span class="st">"CPL"</span>, <span class="st">"CPL"</span>, <span class="st">"IPL"</span>, <span class="st">"CPL"</span>, <span class="st">"CPL"</span>, <span class="st">"CPL"</span>, <span class="st">"CPL"</span><span class="op">)</span>,</span>
<span>  NWCA_WET_GRP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PRLW"</span>, <span class="st">"PRLW"</span>, <span class="st">"PRLH"</span>, <span class="st">"PRLW"</span>, <span class="st">"PRLH"</span>, <span class="st">"PRLW"</span>, <span class="st">"EH"</span>, <span class="st">"EH"</span>, <span class="st">"PRLH"</span>, <span class="st">"PRLH"</span><span class="op">)</span>,</span>
<span>  ECO_X_WETGRP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"CPL-PRLW"</span>, <span class="st">"CPL-PRLW"</span>, <span class="st">"IPL-PRLH"</span>, <span class="st">"CPL-PRLW"</span>, <span class="st">"CPL-PRLH"</span>, <span class="st">"IPL-PRLW"</span>, <span class="st">"ALL-EH"</span>,</span>
<span>    <span class="st">"ALL-EH"</span>, <span class="st">"CPL-PRLH"</span>, <span class="st">"CPL-PRLH"</span></span>
<span>  <span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mets.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">sites</span>, <span class="va">mets</span>, by <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vmmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcVMMI_fromMets.html">calcVMMI_fromMets</a></span><span class="op">(</span><span class="va">mets.1</span>, sampID <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">vmmi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   UID ECO_X_WETGRP FQAI_ALL_SC N_TOL_SC RIMP_NATSPP_SC XRCOV_MONOCOTS_NAT_SC</span></span>
<span><span class="co">## 1   1     CPL-PRLW        4.21        8             10                  0.05</span></span>
<span><span class="co">## 2   2     CPL-PRLW        7.74        6           9.33                  0.37</span></span>
<span><span class="co">## 3   3     IPL-PRLH        4.57     7.75           7.84                  8.95</span></span>
<span><span class="co">## 4   4     CPL-PRLW        7.42     7.25           9.41                  0.32</span></span>
<span><span class="co">## 5   5     CPL-PRLH        2.97       10             10                  9.84</span></span>
<span><span class="co">## 6   6     IPL-PRLW          10        1           9.18                  1.98</span></span>
<span><span class="co">##   VMMI VEGCOND</span></span>
<span><span class="co">## 1 55.7    FAIR</span></span>
<span><span class="co">## 2 58.6    GOOD</span></span>
<span><span class="co">## 3 72.8    GOOD</span></span>
<span><span class="co">## 4   61    GOOD</span></span>
<span><span class="co">## 5   82    GOOD</span></span>
<span><span class="co">## 6 55.4    GOOD</span></span></code></pre>
<p>If we lack the ecoregion or wetland type information in the input
data frame, the function still calculates the VMMI but generates a
warning.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vmmi.alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcVMMI_fromMets.html">calcVMMI_fromMets</a></span><span class="op">(</span><span class="va">mets</span>, sampID <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Warning: Must include variables NWCA_WET_GRP and NWCA_ECO4 OR ECO_X_WETGRP to determine condition class. This variable is missing, and condition class will not be assigned, but VMMI will be calculated."</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">vmmi.alt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   UID FQAI_ALL_SC N_TOL_SC RIMP_NATSPP_SC XRCOV_MONOCOTS_NAT_SC VMMI</span></span>
<span><span class="co">## 1   1        4.21     8.00          10.00                  0.05 55.7</span></span>
<span><span class="co">## 2   2        7.74     6.00           9.33                  0.37 58.6</span></span>
<span><span class="co">## 3   3        4.57     7.75           7.84                  8.95 72.8</span></span>
<span><span class="co">## 4   4        7.42     7.25           9.41                  0.32 61.0</span></span>
<span><span class="co">## 5   5        2.97    10.00          10.00                  9.84 82.0</span></span>
<span><span class="co">## 6   6       10.00     1.00           9.18                  1.98 55.4</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="reference">4 Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>US Environmental Protection Agency. 2016. National Wetland Condition
Assessment: 2011 Technical Report. EPA-843-R-15-006. US Environmental
Protection Agency, Washington, DC.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Karen Blocksom.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
